  Descri√ß√£o
  Este projeto visa melhorar o sistema de IA do Whaticket para criar um agente de IA inteligente e aut√¥nomo que mant√©m contexto da conversa, reconhece filas e tags
  existentes no sistema, executa a√ß√µes automaticamente e faz resumos inteligentes para economizar tokens.

  Objetivo
   - Implementar contexto persistente usando Redis
   - Criar um agente de IA com acesso ao banco de dados
   - Permitir que a IA transfira para filas e adicione tags automaticamente     
   - Implementar resumos inteligentes para economizar tokens
   - Melhorar a experi√™ncia de atendimento ao cliente

  Arquivos a serem alterados

  Backend
   1. backend/src/services/IntegrationsServices/OpenAiService.ts - Principal servi√ßo de IA      
   2. backend/src/services/WbotServices/wbotMessageListener.ts - Listener de mensagens
   3. backend/src/services/WebhookService/ActionsWebhookService.ts - Servi√ßo de a√ß√µes do webhook
   4. backend/src/libs/redis.ts - Configura√ß√£o do Redis (se necess√°rio)
   5. backend/src/utils/sessionContextManager.ts - Novo servi√ßo para gerenciamento de contexto  
   6. backend/src/utils/conversationSummarizer.ts - Novo servi√ßo para resumos

  Frontend
   1. frontend/src/components/FlowBuilderAddOpenAIModal/index.js - Modal de configura√ß√£o do OpenAI
   2. frontend/src/components/FlowBuilderGeminiModal/index.js - Modal de configura√ß√£o do Gemini

  Checklist de Implementa√ß√£o

  ‚úÖ Conclu√≠do
   - [x] Aumentar limite de tokens para 16000 no frontend OpenAI
   - [x] Aumentar limite de tokens para 16000 no frontend Gemini
   - [x] Modificar backend para permitir at√© 16000 tokens para modelos GPT-4    

  üìã A Fazer
   - [ ] Configura√ß√£o do Redis para armazenamento de contexto (existente no docker-compose.yml)
   - [ ] Cria√ß√£o do servi√ßo de gerenciamento de contexto de sess√£o
   - [ ] Atualiza√ß√£o do OpenAiService para usar contexto persistente
   
   - [ ] Implementar servi√ßo de resumos inteligentes para conversas longas
   - [ ] Implementar acesso √†s filas do sistema no agente de IA
   - [ ] Implementar acesso √†s tags do sistema no agente de IA
   - [ ] Criar funcionalidades de transfer√™ncia autom√°tica de filas
   - [ ] Criar funcionalidades de adi√ß√£o autom√°tica de tags
   - [ ] Atualizar o listener de mensagens para usar o novo contexto
   - [ ] Atualizar o servi√ßo de a√ß√µes do webhook para integrar com o agente
   - [ ] Testes de integra√ß√£o
   - [ ] Documenta√ß√£o da API do agente de IA

  Resumos Inteligentes
   - O agente far√° resumos autom√°ticos de conversas longas para economizar tokens
   - Manter√° o contexto principal enquanto reduz o volume de dados processados   
   - Preserva√ß√£o de informa√ß√µes cr√≠ticas durante o resumo

  Exemplo de Uso de Resumo
  Quando a conversa ultrapassar um limite configur√°vel (ex: 50 mensagens), o sistema:
   1. Gera um resumo conciso mantendo pontos principais
   2. Mant√©m as √∫ltimas N mensagens para contexto imediato
   3. Armazena o resumo no contexto do Redis
   4. Continua a conversa com contexto otimizado

  Funcionalidades do Agente de IA

  Atuais
   - Respostas em modo "permanent" e "temporary"
   - Transfer√™ncia para filas com "A√ß√£o: Transferir para o setor de atendimento"
   - Contexto limitado de conversas anteriores

  Futuras (com implementa√ß√£o completa)
   - Contexto persistente com Redis
   - Acesso a filas existentes no sistema
   - Acesso a tags existentes no sistema
   - Transfer√™ncia autom√°tica para filas espec√≠ficas
   - Adi√ß√£o autom√°tica de tags conforme necessidade
   - Tomada de decis√£o inteligente baseada em dados do sistema
   - Mem√≥ria de conversa perfeita com hist√≥rico completo      
   - Resumos inteligentes para economizar tokens
   - Gest√£o autom√°tica de contexto para otimizar uso de tokens

  Exemplo de Uso

  Com o agente completo implementado, o prompt pode incluir instru√ß√µes como:

   1 Se o caso envolver acidente de trabalho, transfira para a fila "Acidentes de Trabalho".
   2 Se o cliente for demitido sem justa causa, adicione a tag "Demiss√£o Sem Justa Causa".
   3 Fa√ßa resumos de conversas com mais de 30 mensagens para economizar tokens.

  A IA entenderia essas instru√ß√µes e executaria as a√ß√µes automaticamente.

  Benef√≠cios

   - Redu√ß√£o do trabalho manual de configura√ß√£o
   - Atendimento mais inteligente e automatizado
   - Economia de tokens com resumos inteligentes
   - Melhor experi√™ncia para os clientes
   - Integra√ß√£o completa com as funcionalidades do sistema

  Status Atual
  O projeto est√° em fase de implementa√ß√£o com os primeiros passos conclu√≠dos (aumento de tokens e configura√ß√£o do Redis existente) e a implementa√ß√£o do contexto persistente  
  com Redis em andamento. A funcionalidade de resumos inteligentes ser√° implementada na pr√≥xima fase.